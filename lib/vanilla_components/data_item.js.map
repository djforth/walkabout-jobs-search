{"version":3,"sources":["../../src/vanilla_components/data_item.js"],"names":[],"mappings":"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","file":"data_item.js","sourcesContent":["const React           = require(\"react\");\nconst _              = require(\"lodash\");\n\nconst ColumnsStore   = require(\"../stores/columns_store\");\n\n//Mixins\nconst cssMixins  = require(\"morse-react-mixins\").css_mixins;\nconst textMixins = require(\"morse-react-mixins\").text_mixins;\n\nclass DataItem extends React.Component {\n  constructor(props) {\n    super(props);\n    this.active = [{active:false}];\n    // this._select.bind(this);\n    this.state = {data:null, columns:[], datefield:[]};\n\n  }\n\n  componentDidMount() {\n    this.mounted = true;\n    this.setState({data:this.props.data, columns:ColumnsStore.getVisible()});\n\n    ColumnsStore.addChangeListener(\"change\", this._onChange.bind(this));\n  }\n\n\n\n  componentWillUnmount() {\n    this.mounted = false;\n    ColumnsStore.removeChangeListener(\"change\", this._onChange);\n  }\n\n  getFmt(col){\n    if(_.has(col, \"fmt\")){\n      return col.fmt;\n    }\n\n    if(_.has(col, \"type\") ){\n      if(col.type === \"dateTime\"){\n        return \"%d/%m/%Y %H:%M\";\n      }\n      if(col.type === \"date\"){\n        return \"%d/%m/%Y\";\n      }\n    }\n\n    return \"%d/%m/%Y\";\n  }\n\n  displayData(item, col){\n    let key  = col.key;\n    let data = item.get(col.key);\n    // console.log(\"data\", data);\n    if(_.isUndefined(data)){\n      return \"\";\n    }\n\n    if(_.isDate(data)){\n      data = item.get(`${key}Df`);\n      let fmt = this.getFmt(col);\n      return data.formatDate(fmt);\n    }\n\n    return this.rawMarkup(data);\n  }\n\n  renderColumn(col, item){\n    return (\n      <div className={this.checkCss(this.props.css, col.key)} key={_.uniqueId(\"dataItem\")}>\n        {this.displayData(item, col)}\n      </div>\n    );\n  }\n\n  rawMarkup(data) {\n    return <span dangerouslySetInnerHTML={ {__html: data} } />;\n  }\n\n  renderTd(){\n    let item = this.props.data;\n    if(item && this.state.columns){\n       let td = _.map(this.state.columns, function(col){\n         return this.renderColumn(col, item);\n      }.bind(this));\n\n      return td;\n    }\n    return \"\";\n  }\n\n\n  render() {\n    return (\n      <div className=\"row tr vPad5\">\n        {this.renderTd()}\n      </div>\n    );\n  }\n\n  _onChange(){\n    if(this.mounted){\n      this.setState({\n        columns:ColumnsStore.getVisible()\n      });\n    }\n\n  }\n}\n\nObject.assign(DataItem.prototype, cssMixins);\nObject.assign(DataItem.prototype, textMixins);\n\nmodule.exports = DataItem;\n"]}