{"version":3,"sources":["../../src/factories/filters_fcty.js"],"names":[],"mappings":"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","file":"filters_fcty.js","sourcesContent":["//Libraries\nconst Immutable = require(\"immutable\");\nconst _         = require(\"lodash\");\n\n//Morse Libraries\nconst AjaxPromises = require(\"ajax-es6-module\");\nconst DataManager  = require(\"datamanager\");\n\nclass FiltersFcty extends DataManager {\n\n  constructor(title, filter_by, filter_opts, input_type=\"checkbox\"){\n    super();\n    this.ajaxPromises = new AjaxPromises();\n    this.data         = null;\n\n    this.history  = [];\n    this.keys     = null;\n    this.cid      = _.uniqueId(\"filter\");\n\n    this.details   = Immutable.fromJS({title:title, filterBy:filter_by, input_type:input_type, visible:true});\n\n    this.defaults     = (input_type === \"checkbox\") ? {selected:true} : {selected:false};\n\n    if (filter_opts) {\n      this.add(filter_opts);\n    }\n  }\n\n  getDetails(key){\n    if(key){\n      return this.details.get(key);\n    }\n    return \"\";\n  }\n\n  hasDetails(key, val){\n    return this.details.get(key) === val;\n  }\n\n  getSelected(all=false){\n    let selected;\n    if(all){\n      selected = this.data;\n    } else {\n      selected = this.data.filter((d)=>{\n        return d.get(\"selected\");\n      });\n    }\n\n    if(selected.size === 0 && this.details.get(\"input_type\") !== \"checkbox\"){\n      selected = this.data;\n    }\n\n    return {filter_by: this.details.get(\"filterBy\"), selected:selected, all:(selected.size === this.data.size)};\n  }\n\n  isVisible(){\n    return this.details.get('visible');\n  }\n\n  reset(){\n    this.data = this.data.map((d)=>this.addDefaults(d));\n    // console.log(this.data.toJS())\n  }\n\n  setApi(uri){\n    this.url = uri;\n  }\n\n  setSelected(id, value=true, reset=false){\n\n    this.addToHistory();\n    this.data = this.data.map((d)=>{\n      switch(id) {\n        case String(d.get(\"id\")):\n          d = d.set(\"selected\", value);\n          break;\n        case \"all\":\n          d = d.set(\"selected\", value);\n          break;\n        default:\n          if(reset){\n            d = d.set(\"selected\", !value);\n          }\n          break;\n      }\n\n      return d;\n    });\n  }\n\n  setVisible(filters){\n    let filterBy = this.details.get('filterBy');\n    // console.log(filters, filterBy)\n    let vis      = _.includes(filters, filterBy);\n    // console.log('vis', vis);\n    this.details = this.details.set('visible', vis);\n  }\n\n}\n\nmodule.exports = FiltersFcty;\n"]}