{"version":3,"sources":["../../src/stores/tabs_store.js"],"names":[],"mappings":"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","file":"tabs_store.js","sourcesContent":["const EventEmitter  = require(\"events\").EventEmitter;\nconst assign        = require(\"react/lib/Object.assign\");\n\nconst _ = require(\"lodash\");\n\nconst textMixins = require(\"morse-react-mixins\").text_mixins;\nconst TabsDispatcher = require(\"../dispatcher/tabs_dispatcher\");\n\n\n\nconst store = {\n  device       : \"mobile\",\n  tabs         : [],\n  tabs_ids     : [],\n  visible_tabs : [],\n\n\n  emitChange(event) {\n    this.emit(event);\n  },\n\n  addChangeListener(event, callback) {\n    this.on(event, callback);\n  },\n\n  removeChangeListener(event, callback) {\n    this.removeListener(event, callback);\n  },\n\n  addTabs(t, id){\n    id   = id || _.uniqueId();\n    let tabs = this.setIDs(t);\n    this.tabs.push({id:id, items:tabs});\n    return id;\n  },\n\n  changeDevice(d){\n    this.device = d;\n    // this.tabs = _.map(this.tabs, (tab)=>{\n    //   tab.visible = this.setVisibleTabs(tab.tabs);\n    //   return tab;\n    // });\n\n  },\n\n  changeTab(id, t){\n\n    let tabs = this.getTabs(id);\n    let items =  tabs.items;\n    items = _.map(items, (tab)=>{\n      tab.options.active = (tab.id === t);\n      return tab;\n    });\n\n    this.setTabs(id, items);\n  },\n\n  getActive(){\n    let tabs = this.getTabs();\n    let item = _.find(tabs.items, (t)=> t.options.active);\n    return item;\n  },\n\n  getFilters(){\n    let tab = this.getActive();\n    return {filters:tab.filters, filterBy:tab.filterBy};\n  },\n\n  getSearch(){\n    let tab = this.getActive();\n    return tab.search;\n  },\n\n  getTabs(id){\n    let items;\n    if(id){\n      items =  _.find(this.tabs, (tab)=>{\n        return tab.id === id;\n      });\n    } else {\n      items = _.first(this.tabs);\n    }\n    if(items){\n      return items;\n    }\n\n    return {id:null, tabs:[]};\n  },\n\n  isActive(tabsId, id){\n    let tabs = this.getTabs(tabsId);\n    let item = _.find(tabs.items, (t)=> t.id === id);\n    return item.options.active;\n  },\n\n  setIDs(tabs){\n    return _.map(tabs, (tab)=>{\n      tab.id = _.uniqueId();\n      return tab;\n    });\n  },\n\n  setTabs(id, items){\n    this.tabs = _.map(this.tabs, (tab)=>{\n      if(tab.id === id){\n        tab.items = items;\n      }\n\n      return tab;\n    });\n  },\n\n\n  setTitles(tabs){\n    tabs = _.map(tabs, function(tab){\n      if(!_.has(tab, \"title\")){\n        let title = this.capitalize(tab.key);\n        _.set(tab, \"title\", title);\n      }\n\n      return tab;\n    }.bind(this));\n\n    return tabs;\n  }\n};\n\nObject.assign(store, textMixins);\n\n\nconst TabsStore = assign({}, EventEmitter.prototype, store);\n\nconst registeredCallback = function(payload) {\n  let action = payload.action;\n  switch(action.type) {\n    case \"ADDING_TABS\":\n      TabsStore.addTabs(action.tabs, action.id);\n      TabsStore.emitChange(\"adding\");\n      break;\n\n    case \"CHANGE_DEVICE\":\n      TabsStore.changeDevice(action.device);\n      TabsStore.emitChange(\"device_change\");\n      break;\n\n    case \"CHANGE_TAB\":\n      TabsStore.changeTab(action.id, action.tab);\n      TabsStore.emitChange(\"tab_change\");\n      break;\n    }\n};\n\n\nTabsStore.dispatchToken = TabsDispatcher.register(registeredCallback);\nTabsStore.setMaxListeners(0);\n\nmodule.exports = TabsStore;\n"]}